"use strict";(self["webpackChunkSolid"]=self["webpackChunkSolid"]||[]).push([[501],{501:function(e,t,a){a.r(t),a.d(t,{default:function(){return h}});var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"widgetContainer bg-white widgetContainer--scrollable pullFunds"},[a("div",{staticClass:"navigationHeader"},[a("div",{staticClass:"navigationHeader__inner"},[a("span",{staticClass:"icon-Arrow-big-left cancel",on:{click:e.backAction}}),a("p",{staticClass:"title"},[e._v(" "+e._s(e.$t("pull_fund_row_title"))+" ")])])]),a("div",{staticClass:"widgetContainer__body"},[[a("h1",{staticClass:"header-1"},[e._v(" "+e._s(e.$t("pull_fund_headerTitle"))+" ")]),a("el-form",{ref:"linkCard",staticClass:"wise-form"},[a("el-form-item",{staticClass:"is-no-asterisk",attrs:{label:e.$t("pull_from_card_number")}},[a("div",{staticClass:"vgs-input",attrs:{id:"cc-number"}},[e.showSkeleton?a("el-skeleton-item",{attrs:{variant:"h1"}}):e._e()],1)]),a("el-form-item",{staticClass:"is-no-asterisk",attrs:{label:e.$t("pull_from_card_expiry")}},[a("div",{staticClass:"vgs-input",attrs:{id:"cc-expiration-date"}},[e.showSkeleton?a("el-skeleton-item",{attrs:{variant:"h1"}}):e._e()],1)])],1)]],2),a("div",{staticClass:"el-drawer__footer"},[a("el-button",{staticClass:"el-button__brand brand width-100",attrs:{type:"primary"},on:{click:e.createContactFn}},[e._v(" "+e._s(e.$t("next"))+" ")])],1)])},r=[],i=a(9896),o=a(629),d={data(){return{selectedBank:null,showSkeleton:!0,form:null,createdContactId:null}},computed:{...(0,o.Se)("user",["getPersonDetails"]),...(0,o.Se)("account",["getSelectedAccount"])},mounted(){if(window.VGSCollect)this.loadForm();else{const e=this.showLoader();window.addVgsCollectScript((()=>{this.loadForm(),e.close()}))}},methods:{...(0,o.nv)("contact",["createContact","archiveContact","listSelfCards"]),...(0,o.nv)("contact",["getLinkCardToken"]),backAction(){this.drawerBack()},loadForm(){let e=(0,i.dU)("VUE_APP_VGS_VALUTID");const t="prod"===(0,i.dU)("VUE_APP_ENV");this.form=window.VGSCollect.create(e,t?"live":"sandbox",(()=>{}));const a={boxSizing:"border-box",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI"',border:"1px solid #edeff1",borderRadius:"4px",height:"48px",color:"#141414",lineHeight:"40px",outline:"none",padding:"0 15px"};this.form.field("#cc-number",{type:"card-number",name:"debitCard.cardNumber",placeholder:"**** **** **** ****",showCardIcon:!1,validations:["required","validCardNumberExtended"],css:a}),this.form.field("#cc-expiration-date",{type:"card-expiration-date",name:"debitCard",placeholder:"MM / YYYY",yearLength:"4",serializers:[{name:"separate",options:{monthName:"expiryMonth",yearName:"expiryYear"}}],validations:["required","validCardExpirationDate"],css:a}),this.showSkeleton=!1},createContactFn(){const e=this.showLoader(),t=this.form.state["debitCard.cardNumber"],a=this.form.state.debitCard;if(!t.isValid||!a.isValid)return e.close(),this.apiErrorMessage("Invalid card details"),!1;const s=this.getPersonDetails;this.getSelectedAccount.id&&s&&this.createContact({accountId:this.getSelectedAccount.id,name:s.firstName+" "+s.lastName,phone:s.phone,email:s.email,card:{address:{...s.address,addressType:"card"}}}).then((t=>{this.createdContactId=t.id,this.getLinkCardToken(this.createdContactId).then((t=>{const a=this;a.form.submit("/v1/contact/"+this.createdContactId+"/debitcard",{headers:{"sd-debitcard-token":t.debitCardToken},method:"PATCH",mapDotToObject:"merge",data:{debitCard:{address:{...s.address,addressType:""}}}},(function(t,s){e.close(),200!==t?(400===t&&"expiry year"===s.sysMessage?a.apiErrorMessage("Invalid expiry date"):a.apiErrorMessage(s.message),a.createdContactId&&a.archiveContact(a.createdContactId).catch((e=>{a.apiErrorMessage(e)}))):a.drawerPush("pullfromcard")}),(t=>{console.log(t),e.close(),a.createdContactId&&a.archiveContact(a.createdContactId).catch((e=>{a.apiErrorMessage(e)})),a.apiErrorMessage("Something went wrong")}))})).catch((t=>{this.createdContactId&&this.archiveContact(this.createdContactId).catch((e=>{this.apiErrorMessage(e)})),e.close(),this.apiErrorMessage(t)}))})).catch((t=>{e.close(),this.apiErrorMessage(t)}))}}},n=d,c=a(3736),l=(0,c.Z)(n,s,r,!1,null,null,null),h=l.exports}}]);
//# sourceMappingURL=501.1689658294188.js.map