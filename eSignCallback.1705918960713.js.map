{"version":3,"file":"eSignCallback.1705918960713.js","mappings":"uJAAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACJ,EAAIM,GAAG,iBAAiB,EAC9HC,EAAkB,G,6BCQtB,GACAC,OAAAA,CAAAA,EAAAA,GACAC,UACA,IACA,0DACA,2CACA,+CACA,aACAC,EAAAA,EAAAA,IAAAA,GACA,sBACA,yBACA,iDACA,wBAEA,oBACAC,OAAAA,eAAAA,WAAAA,oBACAA,OAAAA,eAAAA,WAAAA,WACAA,OAAAA,eAAAA,WAAAA,cACA,MACA,wBAIA,CAFA,MACA,wBACA,CACA,EACAC,QAAAA,KACA,sDACA,yCACA,6CACAC,YAAAA,GACA,0BAEAC,QAAAA,IAAAA,CAAAA,KAAAA,YAAAA,KAAAA,cAAAA,KACAC,MAAA,UACAC,YAAAA,KACA,qBACA,EAFA,IAIAC,OAAAC,IACA,wBACAC,QAAAA,IAAAA,EAAAA,IAEAC,SAAA,KACAC,EAAAA,OAAAA,GAEA,EACAC,SAAAA,EAAAA,GACA,qBACA,0BACA,qBACAP,MAAA,KACAC,YAAAA,KACA,wBACA,gCACA,0BACA,6CACA,CACA,SACAO,mBAAAA,0CACAC,OAAAA,0CACAC,QAAAA,0CACAC,UAAAA,0CACAC,YAAAA,0CACAC,gBAAAA,0CACAC,gBAAAA,qCACAC,YAAAA,sCAGA,uEACA,mCACA,IAlBA,GAoBA,EArBA,IAuBAb,OAAAC,IACAC,QAAAA,IAAAA,GACA,2BAEAC,SAAA,KACAC,EAAAA,OAAAA,GAEA,CACA,IC3F6S,I,UCOzSU,GAAY,OACd,EACAhC,EACAQ,GACA,EACA,KACA,KACA,MAIF,EAAewB,EAAiB,O","sources":["webpack://Solid/./src/modules/kyb/views/EsignCallback.vue?9d98","webpack://Solid/src/modules/kyb/views/EsignCallback.vue","webpack://Solid/./src/modules/kyb/views/EsignCallback.vue?3fb2","webpack://Solid/./src/modules/kyb/views/EsignCallback.vue"],"sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_vm._v(\" Loading... \")])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    Loading...\n  </div>\n</template>\n<script>\nimport { mapActions, mapMutations } from 'vuex';\nimport loginMixins from '@m/user/mixins/login';\nimport { setEnv } from '@/utils/env';\nexport default {\n  mixins: [loginMixins],\n  created() {\n    try {\n      const tokens = window.sessionStorage.getItem('user_auth_tokens');\n      const appEnv = window.sessionStorage.getItem('app_env');\n      const businessId = window.sessionStorage.getItem('business_id');\n      if(tokens && appEnv && businessId) {\n        setEnv(appEnv);\n        const tokenJson = JSON.parse(tokens);\n        this.setUserAuthToken(tokenJson);\n        this.$http.defaults.headers.common.AUTHORIZATION =\n                'Bearer ' + tokenJson.accessToken;\n\n        this.verifyToken(businessId);\n        window.sessionStorage.removeItem('user_auth_tokens');\n        window.sessionStorage.removeItem('app_env');\n        window.sessionStorage.removeItem('business_id');\n      } else {\n        this.goToWelcomeScreen();\n      }\n    } catch {\n      this.goToWelcomeScreen();\n    }\n  },\n  methods: {\n    ...mapActions('user', ['verifyOtp', 'getPerson', 'login']),\n    ...mapMutations('user', ['setUserAuthToken']),\n    ...mapActions('kyb', ['submitKyb', 'fetchBusiness']),\n    verifyToken(businessId) {\n      const loader = this.showLoader();\n\n      Promise.all([this.getPerson(), this.fetchBusiness(businessId)])\n        .then(([res, business]) => {\n          setTimeout(() => {\n            this.startKYB(res, business);\n          }, 0);\n        })\n        .catch((e) => {\n          this.apiErrorMessage(e);\n          console.log(e);\n        })\n        .finally(() => {\n          loader.close();\n        });\n    },\n    startKYB(person, business) {\n      if (person && person.id && business && business.id) {\n        const loader = this.showLoader();\n        this.submitKyb(business.id)\n          .then(() => {\n            setTimeout(() => {\n              this.loginSuccess(() => {\n                const event = this.$route.query.event;\n                if(event === 'signing_complete') {\n                  this.$router.push('/kyb/businessStatus');\n                } else {\n                  const messageMap = {\n                    access_code_failed: 'Something went wrong, please try again.',\n                    cancel: 'Something went wrong, please try again.',\n                    decline: 'Something went wrong, please try again.',\n                    exception: 'Something went wrong, please try again.',\n                    fax_pending: 'Something went wrong, please try again.',\n                    id_check_failed: 'Something went wrong, please try again.',\n                    session_timeout: 'Session timeout, please try again.',\n                    ttl_expired: 'Session timeout, please try again.',\n                  }\n\n                  this.$apiErrorMessage(messageMap[event] || 'Something went wrong, please try again.');\n                  this.$router.push('/kyb/ownership');\n                }\n              });\n            }, 0);\n          })\n          .catch((e) => {\n            console.log(e);\n            this.apiErrorMessage(e);\n          })\n          .finally(() => {\n            loader.close();\n          });\n      }\n    }\n  }\n}\n</script>","import mod from \"-!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./EsignCallback.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./EsignCallback.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./EsignCallback.vue?vue&type=template&id=24cbbcfc&\"\nimport script from \"./EsignCallback.vue?vue&type=script&lang=js&\"\nexport * from \"./EsignCallback.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_h","$createElement","_c","_self","_v","staticRenderFns","mixins","created","setEnv","window","methods","verifyToken","Promise","then","setTimeout","catch","e","console","finally","loader","startKYB","access_code_failed","cancel","decline","exception","fax_pending","id_check_failed","session_timeout","ttl_expired","component"],"sourceRoot":""}