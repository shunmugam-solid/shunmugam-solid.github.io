"use strict";(self["webpackChunkSolid"]=self["webpackChunkSolid"]||[]).push([[7785],{4383:function(e,t,s){s.r(t),s.d(t,{default:function(){return _}});var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"\n      widgetContainer widgetContainer--center\n      bg-white\n      widgetContainer--full-screen\n      verifying\n      appStatus appStatus--verifying\n    "},[s("div",{staticClass:"widgetContainer__body"},[s("LottieAnimation",{attrs:{"animation-name":"searching",reference:"business-status-review-1",loop:!0}}),s("p",{staticClass:"title"},[e._v(" "+e._s(e.$t("esign_callbackTitle"))+" ")]),s("div",{staticClass:"widgetContainer__footer--fixed"},[s("el-button",{staticClass:"welcome__get-started el-button__brand brand",attrs:{disabled:!e.isRetryCountReached,type:"primary"},on:{click:function(t){return e.checkStatus(!1)}}},[e._v(" "+e._s(e.$t("esign_ctaText"))+" ")])],1)],1)])])},n=[],o=s(629),r=s(2424),a=s(9896),c=s(6537),u=s(144),h=s(8196);const l=3;var d={mixins:[r.Z],components:{LottieAnimation:c.Z},created(){try{const e=window.sessionStorage.getItem("user_auth_tokens"),t=window.sessionStorage.getItem("app_env"),s=window.sessionStorage.getItem("business_id");e&&t&&s?((0,a.Nb)(t),u["default"].use(h.Z),u["default"].getAuth0Instance().then((()=>{const t=JSON.parse(e);this.setUserAuthToken(t),this.$http.defaults.headers.common.AUTHORIZATION="Bearer "+t.accessToken,this.verifyToken(s),window.sessionStorage.removeItem("user_auth_tokens"),window.sessionStorage.removeItem("app_env"),window.sessionStorage.removeItem("business_id")}))):this.goToWelcomeScreen()}catch{this.goToWelcomeScreen()}},computed:{...(0,o.Se)("kyb",["getSelectedBusiness"])},data(){return{retryCount:0,isRetryCountReached:!1}},methods:{...(0,o.nv)("user",["getPerson"]),...(0,o.OI)("user",["setUserAuthToken"]),...(0,o.OI)("kyb",["setSelectedBusiness"]),...(0,o.nv)("kyb",["submitKyb","fetchBusiness","getOwnershipDisclosure"]),verifyToken(e){const t=this.showLoader();Promise.all([this.getPerson(),this.fetchBusiness(e)]).then((([e,t])=>{this.setSelectedBusiness(t),setTimeout((()=>{this.loginSuccess((()=>{const e=this.$route.query.event;"signing_complete"===e?this.checkStatus():(this.apiErrorMessage("Unable to complete document signing, please try again."),this.$router.push("/kyb/ownersList"))}))}),2e3)})).catch((e=>{this.apiErrorMessage(e),this.$router.push("/kyb/ownersList")})).finally((()=>{t.close()}))},checkStatus(e=!0){this.retryCount<l||!e?this.getOwnershipDisclosure(this.getSelectedBusiness.id).then((t=>{"completed"===t.status?this.startKYB():e&&setTimeout((()=>{this.retryCount+=1,this.checkStatus()}),3e3)})).catch((t=>{"EC_BUSINESS_AGREEMENT_NOT_FOUND"===t.code&&e&&setTimeout((()=>{this.retryCount+=1}),3e3)})):this.retryCount>=l&&(this.isRetryCountReached=!0)},startKYB(){const e=this.getSelectedBusiness;if(e&&e.id){const t=this.showLoader();this.submitKyb(e.id).then((()=>{setTimeout((()=>{this.$router.push("/kyb/businessStatus")}),0)})).catch((e=>{console.log(e),this.apiErrorMessage(e)})).finally((()=>{t.close()}))}}}},g=d,m=s(3736),p=(0,m.Z)(g,i,n,!1,null,null,null),_=p.exports}}]);
//# sourceMappingURL=eSignCallback.1706699928369.js.map