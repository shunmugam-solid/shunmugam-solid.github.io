"use strict";(self["webpackChunkSolid"]=self["webpackChunkSolid"]||[]).push([[6413],{6986:function(t,e,s){s.r(e),s.d(e,{default:function(){return y}});var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"widgetContainer widgetContainer--center bg-white loginOtp"},[s("div",{staticClass:"navigationHeader"},[s("div",{staticClass:"navigationHeader__inner"},[s("span",{staticClass:"icon-Arrow-big-left cancel",on:{click:t.cancel}}),s("p",{staticClass:"title"},[t._v(" "+t._s(t.$t("tfa_NavTitle"))+" ")])])]),s("div",{staticClass:"widgetContainer__body"},[s("el-form",{ref:"user",staticClass:"wise-form",attrs:{model:t.user,rules:t.rules},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.submitForm()},submit:function(t){t.preventDefault()}}},[s("el-form-item",{attrs:{prop:"otp",label:t.$t("tfa_Title")}},[s("MobileOtp",{attrs:{autofocus:!0},model:{value:t.user.otp,callback:function(e){t.$set(t.user,"otp",e)},expression:"user.otp"}})],1),s("p",{staticClass:"loginOtp__resend-text"},[s("span",{directives:[{name:"show",rawName:"v-show",value:t.timer>0,expression:"timer > 0"}],staticClass:"loginOtp__resend-timer"},[t._v("00:"+t._s(1===(""+this.timer).length?"0"+this.timer:this.timer))]),s("span",{staticClass:"loginOtp__resend-btn",class:{"is-disabled":t.timer>0||t.isDisabled},on:{click:t.resendOtp}},[t._v(t._s(t.$t("tfa_Resend")))])])],1),s("div",{staticClass:"widgetContainer__footer--fixed border-0"},[s("el-button",{staticClass:"el-button__brand brand",attrs:{"data-testid":"submit",type:"primary",disabled:t.isFormInValid||t.isDisabled},on:{click:function(e){return t.submitForm()}}},[t._v(" "+t._s(t.$t("next"))+" ")])],1)],1)])},a=[],r=s(144),n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"el-input"},[s("the-mask",{ref:"otpNumber",staticClass:"el-input__inner",attrs:{mask:"######",type:"tel",autocomplete:"off",name:"otp",masked:!0,value:t.value},nativeOn:{input:function(e){return t.updateInput(e)}}})],1)},o=[],l=s(2982),u={components:{TheMask:l.TheMask},props:{value:{type:String,default:""},autofocus:{type:Boolean,default:!1}},mounted(){this.autofocus&&this.$refs.otpNumber.$el.focus()},methods:{updateInput(t){let e=t.target.value;e?this.$emit("input",e.replace(/\D+/g,"")):this.$emit("input",null)}}},c=u,h=s(3736),p=(0,h.Z)(c,n,o,!1,null,"1f5c6868",null),d=p.exports,m=s(629),f=s(2424),g=s(9896),b=s(7936);r["default"].use(b.VueReCaptcha,{siteKey:"6LesGLoaAAAAAPw7-E2MRHpomm9YGA0MCnZ3otRI"});var _={name:"Login",mixins:[f.Z],components:{MobileOtp:d},data(){return{timer:60,isDisabled:!1,recaptchaToken:"",sitekey:"6LesGLoaAAAAAPw7-E2MRHpomm9YGA0MCnZ3otRI",user:{otp:""},rules:{otp:"required"}}},computed:{...(0,m.Se)("user",["getUserDetails"]),isFormInValid(){return!this.user.otp||6!=this.user.otp.length}},created(){this.timerStart();const t=this.getUserDetails;t&&t.phone||this.$router.push("/user/login")},mounted(){const t=this.$recaptchaInstance;t&&t.showBadge()},methods:{...(0,m.nv)("user",["verifyOtp","getPerson","login"]),...(0,m.OI)("user",["updateUserOtp","setUserDetails"]),async loginWithRecaptcha(){this.isDisabled=!0,await this.$recaptchaLoaded();const t=await this.$recaptcha("login"),e=this.getUserDetails,s=this.showLoader();this.login({mobileNumber:e.phone,recaptchaToken:t}).then((()=>{this.lastResendTime=new Date,this.$notify({title:"Success",message:this.$t("tfa_ResendSuccess"),type:"success"})})).catch((t=>{this.apiErrorMessage(t)})).finally((()=>{this.isDisabled=!1,s.close(),this.timerStart(),this.isDisabled=!1}))},submitForm(){if(this.isFormInValid)return;this.isDisabled=!0;const t=this.getUserDetails,e=(0,g._7)("programCode")||(0,g.Eb)("programCode");if(t&&t.phone)if(!0!==t.programCodeRequired||e)if(!0===t.idNumberLast4Required)this.updateUserOtp(this.user.otp),this.$router.push("/user/loginSSN");else{const s=this.showLoader(),i={otp:this.user.otp};e&&!0===t.programCodeRequired&&(i.programCode=e),this.verifyOtp(i).then((()=>{setTimeout((()=>{const t=this.showLoader();this.getPerson().then((()=>{setTimeout((()=>{this.loginSuccess()}),0)})).catch((t=>{this.apiErrorMessage(t),console.log(t)})).finally((()=>{t.close()}))}),0)})).catch((t=>{this.apiErrorMessage(t),"EC_Identity_ERROR"===t.code&&(this.user.otp=""),console.log(t)})).finally((()=>{this.isDisabled=!1,s.close()}))}else this.updateUserOtp(this.user.otp),this.$router.push("/user/loginProgramCode")},resendOtp(){if(0===this.timer){const t=this.getUserDetails;t&&t.phone&&this.loginWithRecaptcha()}},cancel(){this.setUserDetails({phone:null,idNumberLast4Required:null,otp:null}),setTimeout((()=>{this.$router.push("/user/login")}),0)},timerStart(){this.timer=60;let t=setInterval((()=>{this.timer=this.timer-1,0===this.timer&&clearInterval(t)}),1e3)}},destroyed(){const t=this.$recaptchaInstance;t&&t.hideBadge()}},v=_,C=(0,h.Z)(v,i,a,!1,null,null,null),y=C.exports}}]);
//# sourceMappingURL=login-otp.1689658294188.js.map