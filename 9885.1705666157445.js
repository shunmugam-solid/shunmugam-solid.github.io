"use strict";(self["webpackChunkSolid"]=self["webpackChunkSolid"]||[]).push([[9885],{9885:function(t,e,i){i.r(e),i.d(e,{default:function(){return y}});var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"widgetContainer shippingAddress"},[i("div",{staticClass:"navigationHeader"},[i("div",{staticClass:"navigationHeader__inner"},[i("span",{staticClass:"icon-Arrow-big-left cancel",on:{click:function(e){return t.drawerBack()}}}),i("p",{staticClass:"title"},[t._v(" "+t._s(t.$t("set_ATM_Pin"))+" ")])])]),i("div",{staticClass:"widgetContainer__body"},[i("el-form",{ref:"atmPinForm",staticClass:"wise-form set-pin",attrs:{model:t.formData,rules:t.formRules}},[i("div",{staticClass:"field-wrapper d-none",attrs:{id:"dummy"}}),i("el-form-item",{attrs:{prop:"pin",label:t.$t("enter_pin_text")}},[i("div",[i("input-box",{attrs:{"focus-first-input":t.setFocusFirstInput},on:{change:function(e){return t.formData.pin=e}}})],1)]),i("el-form-item",{attrs:{prop:"rePin",label:t.$t("re-enter_pin_text")}},[i("div",[i("input-box",{attrs:{"reset-fields":t.setFocusFirstInput},on:{change:function(e){return t.formData.rePin=e}}})],1)])],1),i("p",{staticClass:"desclaimer-text"},[t._v(" "+t._s(t.$t("pin_use_desclaimer"))+" "),t.isLearnMoreVisible?i("a",{attrs:{target:"_blank",href:t.learnMoreUrl}},[t._v(t._s(t.$t("learn_more")))]):t._e()])],1),i("div",{staticClass:"el-drawer__footer"},[i("el-button",{staticClass:"el-button__brand brand width-100",attrs:{"data-testid":"submit",type:"primary",disabled:!t.isFormValid},on:{click:t.next}},[t._v(" "+t._s(t.$t("save"))+" ")])],1)])},s=[],o=(i(1703),i(629)),a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"otp-container"},[i("el-input",{ref:"otpcode1",attrs:{type:"password",value:t.formData.otpcode1,disabled:t.isTemporarilyDisabled,inputmode:"numeric",pattern:"[0-9]*",autocomplete:"one-time-code"},on:{input:function(e){return t.handleInput(1,e)}},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"delete",[8,46],e.key,["Backspace","Delete","Del"])?null:t.handleDelete(1)}}}),i("el-input",{ref:"otpcode2",attrs:{type:"password",inputmode:"numeric",pattern:"[0-9]*",value:t.formData.otpcode2,disabled:t.isTemporarilyDisabled},on:{input:function(e){return t.handleInput(2,e)}},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"delete",[8,46],e.key,["Backspace","Delete","Del"])?null:t.handleDelete(2)}}}),i("el-input",{ref:"otpcode3",attrs:{type:"password",inputmode:"numeric",pattern:"[0-9]*",value:t.formData.otpcode3,disabled:t.isTemporarilyDisabled},on:{input:function(e){return t.handleInput(3,e)}},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"delete",[8,46],e.key,["Backspace","Delete","Del"])?null:t.handleDelete(3)}}}),i("el-input",{ref:"otpcode4",attrs:{type:"password",inputmode:"numeric",pattern:"[0-9]*",value:t.formData.otpcode4,disabled:t.isTemporarilyDisabled},on:{input:function(e){return t.handleInput(4,e)}},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"delete",[8,46],e.key,["Backspace","Delete","Del"])?null:t.handleDelete(4)}}})],1)},r=[],l={props:{otpNumber:{type:String,default:""},focusFirstInput:{type:Boolean,default:!1},resetFields:{type:Boolean,default:!1}},data(){return{isTemporarilyDisabled:!1,formData:{otpcode1:null,otpcode2:null,otpcode3:null,otpcode4:null}}},computed:{otpcode(){let t=this.formData;return Object.keys(this.formData).some((t=>null==this.formData[t]))?"":`${t.otpcode1}${t.otpcode2}${t.otpcode3}${t.otpcode4}`}},mounted(){this.setFocusFirstInput();const t=document.querySelector("div.otp-container");t.addEventListener("paste",(t=>{let e=(t.clipboardData||window.clipboardData).getData("text");if(null!=e){let t=e.match(/(\d+)/);if(null!=t&&null!=t[0]){let e=t[0];if(4===e.length){for(let t in e){let i=`otpcode${parseInt(t)+1}`;this.formData[i]=e[t]}4===this.otpcode.length&&this.$emit("done",this.otpcode)}}}t.preventDefault()}))},methods:{resetInputFields(){this.formData.otpcode1=null,this.formData.otpcode2=null,this.formData.otpcode3=null,this.formData.otpcode4=null},setFocusFirstInput(){this.$refs.otpcode1.focus()},isFilled(){return 4===this.otpcode.length},handleInput(t,e){let i=/[0-9]/g.test(e)?e+"":null;if(null==i)return;let n=parseInt(i),s=4===t,o=`otpcode${t}`;if(!n||4!==this.otpcode.length)if(null==this.formData[o])if(isNaN(n)||null==n)this.formData[o]=null;else{if(this.formData[o]=n,s||this.$refs["otpcode"+(t+1)].focus(),s&&this.otpcode.length<4){let t=Object.keys(this.formData).find((t=>null==this.formData[t]));this.$refs[t].focus()}4===this.otpcode.length&&this.$emit("done",this.otpcode),this.$emit("change",this.otpcode)}else{let e=parseInt((n+"").slice(-1));this.handleInput(t+1,e)}},handleDelete(t){let e=1===t,i=`otpcode${t}`;if(this.$emit("changeOTP"),null==this.formData[i]&&!e)return this.$refs["otpcode"+(t-1)].focus(),void(this.formData["otpcode"+(t-1)]=null);null!=this.formData[i]&&(this.formData[i]=null),this.$emit("change",this.otpcode)},disableTemporarily(t){this.isTemporarilyDisabled=!0,setTimeout((()=>{this.isTemporarilyDisabled=!1}),1e3*t)}},watch:{otpNumber:{handler:function(t){if(t&&4===t.length)for(let e in t)this.handleInput(parseInt(e)+1,t[e])},deep:!0},resetFields:function(t){1==t&&this.resetInputFields()},focusFirstInput:function(t){1==t&&(this.resetInputFields(),this.setFocusFirstInput())}}},d=l,p=i(3736),u=(0,p.Z)(d,a,r,!1,null,null,null),c=u.exports,h=i(9896),f={name:"SetATMPin",components:{InputBox:c},data(){var t=(t,e,i)=>{e!==this.formData.pin?i(new Error(this.$t("pin_mismatch_error"))):i()};return{setFocusFirstInput:!1,formData:{pin:"",rePin:""},formRules:{rePin:[{validator:t}]}}},computed:{...(0,o.Se)("card",["getSelectedCard"]),isFormValid(){return this.formData.pin&&4===this.formData.pin.length&&this.formData.pin===this.formData.rePin},learnMoreUrl(){return(0,h._7)("atmPinLearnMore")},isLearnMoreVisible(){return(0,h._7)("atmPinLearnMore")}},mounted(){if(window.VGSCollect)this.loadForm();else{const t=this.showLoader();window.addVgsCollectScript((()=>{this.loadForm(),t.close()}))}},methods:{...(0,o.nv)("card",["pinToken"]),notificationClosed(){this.$refs.atmPinForm.resetFields(),this.setFocusFirstInput=!0,this.$nextTick((()=>{this.setFocusFirstInput=!1}))},loadForm(){let t=(0,h.dU)("VUE_APP_VGS_VALUTID");const e="prod"===(0,h.dU)("VUE_APP_ENV");this.form=window.VGSCollect.create(t,e?"live":"sandbox",(()=>{})),this.form.field("#dummy",{type:"text",name:"dummy"})},next(){this.$refs.atmPinForm.validate((t=>{if(!t)return;const e="0123456789",i="9876543210",n=this.formData.pin;if(-1!==e.indexOf(n)||-1!==i.indexOf(n)||n.split(n.charAt(0)).length-1===4)this.$notify({title:"Error",message:this.$t("atm_pin_combination"),type:"error",onClose:this.notificationClosed});else{const t=this.showLoader(),e=this.getSelectedCard.id,i=this.getSelectedCard,s={pin:n,expiryMonth:i.expiryMonth,expiryYear:i.expiryYear,last4:i.last4};this.pinToken(e).then((i=>{const n={"sd-pin-token":i.pinToken};this.form.submit(`/v1/card/${e}/pin`,{data:()=>s,headers:n},((e,i)=>{t.close(),200===e&&i&&(this.$notify({title:"Success",message:this.$t("pin_set_success"),type:"success"}),this.drawerPush("CardManagement"))}),(function(e){console.log("errors",e),t.close()}))})).catch((e=>{t.close(),this.apiErrorMessage(e)}))}}))}}},m=f,D=(0,p.Z)(m,n,s,!1,null,"963ad3e6",null),y=D.exports}}]);
//# sourceMappingURL=9885.1705666157445.js.map