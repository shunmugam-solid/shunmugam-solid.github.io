"use strict";(self["webpackChunkSolid"]=self["webpackChunkSolid"]||[]).push([[7785],{3075:function(e,t,s){s.r(t),s.d(t,{default:function(){return m}});var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"\n      widgetContainer widgetContainer--center\n      bg-white\n      widgetContainer--full-screen\n      verifying\n      appStatus appStatus--verifying\n    "},[s("div",{staticClass:"widgetContainer__body"},[s("LottieAnimation",{attrs:{"animation-name":"searching",reference:"business-status-review-1",loop:!0}}),s("p",{staticClass:"title"},[e._v(" "+e._s(e.$t("esign_callbackTitle"))+" ")]),s("div",{staticClass:"widgetContainer__footer--fixed"},[s("el-button",{staticClass:"welcome__get-started el-button__brand brand",attrs:{disabled:!e.isRetryCountReached,type:"primary"},on:{click:function(t){return e.checkStatus(!1)}}},[e._v(" "+e._s(e.$t("esign_ctaText"))+" ")])],1)],1)])])},n=[],o=s(629),a=s(2424),r=s(9896),c=s(6537);const u=3;var h={mixins:[a.Z],components:{LottieAnimation:c.Z},created(){try{const e=window.sessionStorage.getItem("user_auth_tokens"),t=window.sessionStorage.getItem("app_env"),s=window.sessionStorage.getItem("business_id");if(e&&t&&s){(0,r.Nb)(t);const i=JSON.parse(e);this.setUserAuthToken(i),this.$http.defaults.headers.common.AUTHORIZATION="Bearer "+i.accessToken,this.verifyToken(s),window.sessionStorage.removeItem("user_auth_tokens"),window.sessionStorage.removeItem("app_env"),window.sessionStorage.removeItem("business_id")}else this.goToWelcomeScreen()}catch{this.goToWelcomeScreen()}},computed:{...(0,o.Se)("kyb",["getSelectedBusiness"])},data(){return{retryCount:0,isRetryCountReached:!1}},methods:{...(0,o.nv)("user",["getPerson"]),...(0,o.OI)("user",["setUserAuthToken"]),...(0,o.OI)("kyb",["setSelectedBusiness"]),...(0,o.nv)("kyb",["submitKyb","fetchBusiness","getOwnershipDisclosure"]),verifyToken(e){const t=this.showLoader();Promise.all([this.getPerson(),this.fetchBusiness(e)]).then((([e,t])=>{this.setSelectedBusiness(t),setTimeout((()=>{this.loginSuccess((()=>{const e=this.$route.query.event;if("signing_complete"===e)this.checkStatus();else{const t={access_code_failed:"Something went wrong, please try again.",cancel:"Something went wrong, please try again.",decline:"Something went wrong, please try again.",exception:"Something went wrong, please try again.",fax_pending:"Something went wrong, please try again.",id_check_failed:"Something went wrong, please try again.",session_timeout:"Session timeout, please try again.",ttl_expired:"Session timeout, please try again."};this.apiErrorMessage(t[e]||"Something went wrong, please try again."),this.$router.push("/kyb/ownersList")}}))}),2e3)})).catch((e=>{this.apiErrorMessage(e),console.log(e)})).finally((()=>{t.close()}))},checkStatus(e=!0){this.retryCount<u||!e?this.getOwnershipDisclosure(this.getSelectedBusiness.id).then((t=>{"completed"===t.status?this.startKYB():e&&setTimeout((()=>{this.retryCount+=1,this.checkStatus()}),3e3)})).catch((t=>{"EC_BUSINESS_AGREEMENT_NOT_FOUND"===t.code&&e&&setTimeout((()=>{this.retryCount+=1}),3e3)})):this.retryCount>=u&&(this.isRetryCountReached=!0)},startKYB(){const e=this.getSelectedBusiness;if(e&&e.id){const t=this.showLoader();this.submitKyb(e.id).then((()=>{setTimeout((()=>{this.$router.push("/kyb/businessStatus")}),0)})).catch((e=>{console.log(e),this.apiErrorMessage(e)})).finally((()=>{t.close()}))}}}},l=h,g=s(3736),d=(0,g.Z)(l,i,n,!1,null,null,null),m=d.exports}}]);
//# sourceMappingURL=eSignCallback.1706558449530.js.map