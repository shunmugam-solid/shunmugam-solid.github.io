"use strict";(self.webpackChunkdrop_in_ui=self.webpackChunkdrop_in_ui||[]).push([[9336],{7427:function(t,n,a){a.d(n,{a:function(){return l},f:function(){return c}});var e=a(9831),r=a(1951),i=a(80),s=a(286),o=a(7514),c=function(t,n,a,c,l,u,d){return function(m,f){return new Promise((function(_,h){var p="cash"===n?"v1/account/".concat(t,"/transaction?limit=").concat(a,"&offset=").concat(c):"v1/crypto/".concat(t,"/transaction?limit=").concat(a,"&offset=").concat(c);if(d&&(p+="&export=".concat(d)),l&&l.length>0&&(p+="&query=".concat(encodeURIComponent(l))),u){var x=u;Object.keys(u).forEach((function(t){x[t]&&(p+="crypto"===n&&"startDate"===t?"&startTime=".concat(x[t]):"crypto"===n&&"endDate"===t?"&endTime=".concat(x[t]):"&".concat(t,"=").concat(x[t]))}))}setTimeout((function(){"pdf"===d?(0,i.V_)(!0):m((0,o.Rn)(!0))}),0),s.Z.get(p,{responseType:"pdf"===d?"blob":"json"}).then((function(t){var n=t.data;if("pdf"!==d){var a=f().transaction.txnList,i=f().transaction.transactions;0===c&&(a={},i=[]),n.data.forEach((function(t){var n=(0,e.default)(t.txnDate),s=(0,r.default)(n,"MMMM yyyy");a[s]?a[s].push(t):a[s]=[t],i.push(t)})),m((0,o.XI)({transactions:i,txnList:a,total:n.total}))}_(n)})).catch(h).finally((function(){"pdf"===d?(0,i.V_)(!1):m((0,o.Rn)(!1))}))}))}},l=function(t,n,a){var e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"json";return function(r){return new Promise((function(c,l){(0,i.V_)(!0);var u="crypto"===n?"v1/crypto/".concat(t,"/transaction/").concat(a):"v1/account/".concat(t,"/transaction/").concat(a,"?export=").concat(e);s.Z.get(u,{responseType:"pdf"===e?"blob":"json"}).then((function(t){var n=t.data;"pdf"!==e&&r((0,o.IR)(n)),c(n)})).catch((function(t){t.response&&t.response.data?l(t.response.data):l(t)})).finally((function(){(0,i.V_)(!1)}))}))}}},9336:function(t,n,a){a.d(n,{Z:function(){return A}});var e=a(1413),r=a(9439),i=a(2791),s=a(2020),o=a(8735),c=a(5798),l=a(6450),u=a(5048),d=a(4771),m=a(1951),f=a(7689),_=a(4144),h={bodyStyles:"TransactionsList_bodyStyles__DV1tn",transaction__box:"TransactionsList_transaction__box__rlmOM",scrollableDiv:"TransactionsList_scrollableDiv__lUBu3",transactions__search:"TransactionsList_transactions__search__X7iW3",transactions__search__icon:"TransactionsList_transactions__search__icon__rJTxm",transactions__search__input:"TransactionsList_transactions__search__input__YC3Vr",transactions__filter:"TransactionsList_transactions__filter__U5l+w",transactions__list_month:"TransactionsList_transactions__list_month__7mtUP",transactions__month_header:"TransactionsList_transactions__month_header__6369R",transactions__list_item:"TransactionsList_transactions__list_item__elp8k",tag:"TransactionsList_tag__vt8SQ",tag__intrabank:"TransactionsList_tag__intrabank__rkOgY",tag__card:"TransactionsList_tag__card__I1gKw",transaction__description:"TransactionsList_transaction__description__XrkJ8",transaction__received:"TransactionsList_transaction__received__k9ILX",transaction__sent:"TransactionsList_transaction__sent__HFnJf"},p=a(5304),x=a(729),v=a(80),g=a(6559),T=a(1605),y=a(7427),D=a(7514),j=a(4661),w=a(3692),N=a(184),C=i.lazy((function(){return Promise.all([a.e(4398),a.e(4044),a.e(5326),a.e(219)]).then(a.bind(a,219))})),b=i.memo((function(t){var n,e=t.transactionData,r=t.dateFormat,c=(0,s.$)().t,l=(0,j.y)().open,d=(0,p.CG)((function(t){return t.core.ui}),u.wU),f=(0,i.useMemo)((function(){return(0,m.default)(new Date(e.createdAt),r)}),[r,e.createdAt]),_=(0,i.useMemo)((function(){var t=e.walletId?e.amount:(0,v.OH)(e.amount);return parseFloat(e.amount)>0?"+".concat(t):t}),[e]),x=(0,i.useMemo)((function(){var t,n;return"pending"===e.status?"#FFAC4A":"canceled"===e.status?"#FF4A4A":"".concat("debit"===e.txnType?null===(t=d.modules.transactions)||void 0===t?void 0:t.amountSentColor:null===(n=d.modules.transactions)||void 0===n?void 0:n.amountReceivedColor)}),[e]);return(0,N.jsxs)(o.HC,{backgroundColor:"var(--bg-white)","data-class":"transaction-list-item","data-testid":"transaction-item-".concat(e.id),onClick:function(){l(i.lazy((function(){return Promise.all([a.e(9259),a.e(714)]).then(a.bind(a,714))})),{id:e.id})},className:h.transactions__list_item,children:[(0,N.jsx)(o.xu,{className:"".concat(h.tag," ").concat(h["tag__".concat(e.transferType)]),children:(0,N.jsx)(o.xv,{textTransform:"capitalize",variant:"small",textAlign:"center",color:"inherit",textOverflow:"ellipsis",overflow:"hidden",children:c(["transactions_list.".concat(e.transferType),e.transferType||""])})}),(0,N.jsxs)(o.xu,{className:h.transaction__description,children:[(0,N.jsx)(o.xv,{variant:"regular",className:"text-dark",textAlign:"left",children:e.title}),(0,N.jsx)(o.xv,{variant:"small",className:"text-light",textAlign:"left",children:"pending"===e.status?"Pending":f})]}),(0,N.jsx)(o.xv,{variant:"small",title:"".concat((0,v.OH)(e.amount)),textAlign:"right",fontWeight:null===(n=d.modules.transactions)||void 0===n?void 0:n.amountFontWeight,color:x,children:_})]})})),A=function(t){var n=t.showFilter,a=t.showExport,m=t.showMonth,A=t.scrollBoxHeight,S=t.showSearch,U=t.showCompactView,L=t.accountType,k=t.filterRequest,Z=t.transactionsPerView,M=void 0===Z?20:Z,z=t.dateFormat,O=(0,s.$)().t,F=(0,j.y)().open,I=(0,f.s0)(),R=(0,i.useState)(""),H=(0,r.Z)(R,2),P=H[0],V=H[1],E=(0,i.useState)(""),J=(0,r.Z)(E,2),G=J[0],$=J[1],Y=(0,i.useRef)(0),W=(0,i.useRef)(!1),X=(0,p.Qo)(),q=(0,p.CG)((function(t){return t.transaction.transactionLoading}),u.wU),B=(0,p.CG)((function(t){return t.transaction.transactions}),u.wU),Q=(0,p.CG)((function(t){return t.transaction.txnList}),u.wU),K=(0,p.CG)((function(t){return t.transaction.total}),u.wU),tt=(0,p.CG)((function(t){return t.account.selectedAccount}),u.wU),nt=(0,p.CG)((function(t){return t.crypto.selectedAccount}),u.wU),at=(0,p.CG)((function(t){return t.transaction.filters}),u.wU),et=B.length,rt=(0,i.useMemo)((function(){return(0,e.Z)((0,e.Z)({},at.data),{},{timePeriod:at.tmpStates.timePeriod})}),[at]),it=Y.current/M+1;(0,x.bX)((function(){Y.current=0,$(P)}),1e3,[P]);var st=(0,i.useRef)(1),ot=(0,i.useCallback)((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"json",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(0,e.Z)({},rt);console.log("called");var a="cash"===L&&tt?tt.id:"crypto"===L&&nt?nt.id:"";if(""!==a){var r=JSON.parse(JSON.stringify(n));k&&k.type&&k.id?"contact"===k.type?r.contactId=k.id:"card"===k.type&&(r.cardId=k.id):(r.contactId=void 0,r.cardId=void 0),"card"===r.txnType&&(r.txnType=void 0,r.transferType="card"),"0.00"!==r.maxAmount&&"0"!==r.maxAmount||delete r.maxAmount,st.current+=1,st.current<=5?X((0,y.f)(a,L,"pdf"===t?100:M,"pdf"===t?0:Y.current,G,r,t)).then((function(n){if("pdf"===t){var a=window.URL.createObjectURL(n),e=document.createElement("a");e.href=a,e.download="statement.pdf",e.click(),e.remove()}})).catch(v.WH):console.log("count",st.current)}}),[tt,G,Y,M,rt,k,st]);(0,i.useEffect)((function(){ot()}),[G,tt]),(0,i.useEffect)((function(){return w.T.subscribe(w.z.TRANSACTION_REFRESH,(function(){Y.current=0,ot()}))}),[rt]);var ct=(0,i.useCallback)((function(){I("/transactions")}),[]),lt=(0,i.useCallback)((function(t){var n=JSON.parse(JSON.stringify((0,e.Z)({},at))),a=n.data,r=n.tmpStates;"txnType"===t?(a.txnType=void 0,a.transferType=void 0,r.transactionType=void 0):"amount"===t?(a.minAmount=void 0,a.maxAmount=void 0,r.amount={min:"",max:""}):"timePeriod"===t&&(a.startDate=void 0,a.endDate=void 0,r.startDate=void 0,r.endDate=void 0,r.timePeriod=void 0),X((0,D.L5)({data:a,tmpStates:r})),setTimeout((function(){ot("json",a)}),0)}),[at]),ut=function(){return Object.keys(Q).map((function(t){return(0,N.jsxs)(o.xu,{"data-testid":"month-group-".concat(t.replace(/ /g,"_")),children:[m&&(0,N.jsx)(o.xv,{"data-testid":"month-name-text",variant:"large",className:h.transactions__month_header,children:t}),(0,N.jsx)(o.aV,{className:h.transactions__list_month,"data-class":"transaction-list",children:Q[t].map((function(t){return(0,N.jsx)(b,{transactionData:t,dateFormat:z},t.id)}))})]},"tr-".concat(t))}))},dt=(0,i.useMemo)((function(){return{credit:O("filter.credits"),debit:O("filter.debits"),card:O("filter.cardTransactions")}}),[]);return(0,N.jsx)(o.xu,{className:h.bodyStyles,children:q&&1===it&&!W.current?(0,N.jsx)(g.Z,{name:"TransactionListView",showHeader:!U}):(0,N.jsxs)(o.xu,{width:"100%",className:h.transaction__box,children:[(0,N.jsxs)("div",{children:[(0,N.jsxs)(o.Ug,{width:"100%",children:[(0,N.jsx)(o.xv,{"data-testid":"heading",variant:"large",mr:"auto",children:O("transactions_list.title")}),U&&0!==K?(0,N.jsxs)(o.xv,{variant:"regular",className:"text-light",fontSize:"16px",cursor:"pointer",onClick:ct,children:[O("transactions_list.viewAll"),(0,N.jsx)(_.Z,{style:{marginLeft:"8px"},icon:"Arrow-small-right",size:12,className:"svg-light-grey-1"})]}):null,a?(0,N.jsxs)(o.Ug,{ml:"auto",cursor:"pointer",onClick:function(){return ot("pdf")},"data-testid":"export-icon",children:[(0,N.jsx)(_.Z,{icon:"icon-export",size:16}),(0,N.jsx)(o.xv,{variant:"regular",className:"transactions__export-title",children:O("transactions_list.exportTitle")}),(0,N.jsx)(_.Z,{icon:"Arrow-small-right",size:12,className:"svg-light-grey-1"})]}):null]}),(0,N.jsxs)(o.Ug,{my:S||n?"16px":"0px",children:[S?(0,N.jsxs)(o.xu,{className:h.transactions__search,children:[(0,N.jsx)(_.Z,{icon:"icon-search",className:h.transactions__search__icon,size:18}),(0,N.jsx)(c.II,{"data-testid":"search-input",placeholder:O("transactions_list.searchTransactions"),variant:"primary",className:h.transactions__search__input,value:P,onChange:function(t){W.current=!0,V(t.target.value)}})]}):null,n?(0,N.jsx)(o.M5,{className:"".concat(h.transactions__filter),"data-testid":"filter-handler",onClick:function(){F(C)},children:(0,N.jsx)(_.Z,{icon:"icon-filter",size:20})}):null]})]}),(0,N.jsxs)(o.Ug,{spacing:4,marginBottom:"16px",children:[rt.txnType?(0,N.jsxs)(l.Vp,{variant:"primary",padding:"10px","data-testid":"filter-tag-txnType",children:[(0,N.jsx)(l.Sn,{fontSize:"12px",textTransform:"uppercase",children:dt[rt.txnType]}),(0,N.jsx)(l.SD,{onClick:function(){lt&&lt("txnType")}})]}):null,rt.minAmount&&"0.00"!==rt.minAmount||rt.maxAmount&&"0.00"!==rt.maxAmount?(0,N.jsxs)(l.Vp,{variant:"primary",padding:"10px","data-testid":"filter-tag-amount",children:[(0,N.jsx)(l.Sn,{fontSize:"12px",textTransform:"uppercase",children:rt.minAmount&&rt.maxAmount&&"0.00"!==rt.minAmount&&"0.00"!==rt.maxAmount?"".concat((0,v.OH)(rt.minAmount)," - ").concat((0,v.OH)(rt.maxAmount)):rt.minAmount&&"0.00"!==rt.minAmount?(0,v.OH)(rt.minAmount):"".concat((0,v.OH)("0.00")," - ").concat((0,v.OH)(rt.maxAmount||""))}),(0,N.jsx)(l.SD,{onClick:function(){lt&&lt("amount")}})]}):null,rt.timePeriod&&("custom"!==rt.timePeriod||rt.startDate&&""!==rt.startDate||rt.endDate&&""!==rt.endDate)?(0,N.jsxs)(l.Vp,{variant:"primary",padding:"10px","data-testid":"filter-tag-time",children:[(0,N.jsx)(l.Sn,{fontSize:"12px",textTransform:"uppercase",children:"custom"===rt.timePeriod?rt.startDate&&rt.endDate&&""!==rt.startDate&&""!==rt.endDate?"".concat(rt.startDate," - ").concat(rt.endDate):rt.startDate&&""!==rt.startDate?rt.startDate:rt.endDate:O("filter.".concat(rt.timePeriod))}),(0,N.jsx)(l.SD,{onClick:function(){lt&&lt("timePeriod")}})]}):null]}),q&&W.current?(0,N.jsx)(g.Z,{name:"TransactionListView",showHeader:!1}):(0,N.jsx)("div",{className:h.scrollableDiv,id:"scrollableDiv",children:U?ut():(0,N.jsx)(d.Z,{scrollThreshold:.6,height:A,dataLength:et,next:function(){Y.current=it*M,setTimeout((function(){console.log("call from infi"),ot()}),0)},hasMore:et<K&&0!==K,loader:(0,N.jsx)(o.M5,{my:3,children:(0,N.jsx)(T.Z,{showModal:!1,show:!0})}),endMessage:q?null:(0,N.jsxs)(N.Fragment,{children:[0!==K?(0,N.jsx)(o.iz,{className:"no_transaction"}):null,(0,N.jsx)(o.M5,{py:2,children:(0,N.jsx)(o.xv,{variant:"regular",textAlign:"center",className:"text-light",children:O(0===K?"transactions_list.noData":"transactions_list.noMoreTransactions")})})]}),scrollableTarget:"scrollableDiv",children:ut()})})]})})}},2729:function(t,n,a){a.d(n,{qk:function(){return i},vh:function(){return r},yJ:function(){return e}});Math.pow(10,8);var e=6e4,r=36e5,i=1e3},9831:function(t,n,a){a.r(n),a.d(n,{default:function(){return s}});var e=a(2729),r=a(4522),i=a(9297);function s(t,n){var a;(0,r.Z)(1,arguments);var s=(0,i.Z)(null!==(a=null===n||void 0===n?void 0:n.additionalDigits)&&void 0!==a?a:2);if(2!==s&&1!==s&&0!==s)throw new RangeError("additionalDigits must be 0, 1 or 2");if("string"!==typeof t&&"[object String]"!==Object.prototype.toString.call(t))return new Date(NaN);var h,p=function(t){var n,a={},e=t.split(o.dateTimeDelimiter);if(e.length>2)return a;/:/.test(e[0])?n=e[0]:(a.date=e[0],n=e[1],o.timeZoneDelimiter.test(a.date)&&(a.date=t.split(o.timeZoneDelimiter)[0],n=t.substr(a.date.length,t.length)));if(n){var r=o.timezone.exec(n);r?(a.time=n.replace(r[1],""),a.timezone=r[1]):a.time=n}return a}(t);if(p.date){var x=function(t,n){var a=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+n)+"})|(\\d{2}|[+-]\\d{"+(2+n)+"})$)"),e=t.match(a);if(!e)return{year:NaN,restDateString:""};var r=e[1]?parseInt(e[1]):null,i=e[2]?parseInt(e[2]):null;return{year:null===i?r:100*i,restDateString:t.slice((e[1]||e[2]).length)}}(p.date,s);h=function(t,n){if(null===n)return new Date(NaN);var a=t.match(c);if(!a)return new Date(NaN);var e=!!a[4],r=d(a[1]),i=d(a[2])-1,s=d(a[3]),o=d(a[4]),l=d(a[5])-1;if(e)return function(t,n,a){return n>=1&&n<=53&&a>=0&&a<=6}(0,o,l)?function(t,n,a){var e=new Date(0);e.setUTCFullYear(t,0,4);var r=e.getUTCDay()||7,i=7*(n-1)+a+1-r;return e.setUTCDate(e.getUTCDate()+i),e}(n,o,l):new Date(NaN);var u=new Date(0);return function(t,n,a){return n>=0&&n<=11&&a>=1&&a<=(f[n]||(_(t)?29:28))}(n,i,s)&&function(t,n){return n>=1&&n<=(_(t)?366:365)}(n,r)?(u.setUTCFullYear(n,i,Math.max(r,s)),u):new Date(NaN)}(x.restDateString,x.year)}if(!h||isNaN(h.getTime()))return new Date(NaN);var v,g=h.getTime(),T=0;if(p.time&&(T=function(t){var n=t.match(l);if(!n)return NaN;var a=m(n[1]),r=m(n[2]),i=m(n[3]);if(!function(t,n,a){if(24===t)return 0===n&&0===a;return a>=0&&a<60&&n>=0&&n<60&&t>=0&&t<25}(a,r,i))return NaN;return a*e.vh+r*e.yJ+1e3*i}(p.time),isNaN(T)))return new Date(NaN);if(!p.timezone){var y=new Date(g+T),D=new Date(0);return D.setFullYear(y.getUTCFullYear(),y.getUTCMonth(),y.getUTCDate()),D.setHours(y.getUTCHours(),y.getUTCMinutes(),y.getUTCSeconds(),y.getUTCMilliseconds()),D}return v=function(t){if("Z"===t)return 0;var n=t.match(u);if(!n)return 0;var a="+"===n[1]?-1:1,r=parseInt(n[2]),i=n[3]&&parseInt(n[3])||0;if(!function(t,n){return n>=0&&n<=59}(0,i))return NaN;return a*(r*e.vh+i*e.yJ)}(p.timezone),isNaN(v)?new Date(NaN):new Date(g+T+v)}var o={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},c=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,l=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,u=/^([+-])(\d{2})(?::?(\d{2}))?$/;function d(t){return t?parseInt(t):1}function m(t){return t&&parseFloat(t.replace(",","."))||0}var f=[31,null,31,30,31,30,31,31,30,31,30,31];function _(t){return t%400===0||t%4===0&&t%100!==0}}}]);
//# sourceMappingURL=9336.d2efafed.chunk.js.map