"use strict";(self.webpackChunkdrop_in_ui=self.webpackChunkdrop_in_ui||[]).push([[9336],{7427:function(t,n,e){e.d(n,{a:function(){return l},f:function(){return c}});var a=e(9831),r=e(1951),i=e(80),s=e(286),o=e(7514),c=function(t,n,e,c,l,u,d){return function(f,m){return new Promise((function(_,h){var p="cash"===n?"v1/account/".concat(t,"/transaction?limit=").concat(e,"&offset=").concat(c):"v1/crypto/".concat(t,"/transaction?limit=").concat(e,"&offset=").concat(c);if(d&&(p+="&export=".concat(d)),l&&l.length>0&&(p+="&query=".concat(encodeURIComponent(l))),u){var v=u;Object.keys(u).forEach((function(t){v[t]&&(p+="crypto"===n&&"startDate"===t?"&startTime=".concat(v[t]):"crypto"===n&&"endDate"===t?"&endTime=".concat(v[t]):"&".concat(t,"=").concat(v[t]))}))}setTimeout((function(){"pdf"===d?(0,i.V_)(!0):f((0,o.Rn)(!0))}),0),s.Z.get(p,{responseType:"pdf"===d?"blob":"json"}).then((function(t){var n=t.data;if("pdf"!==d){var e=m().transaction.txnList,i=m().transaction.transactions;0===c&&(e={},i=[]),n.data.forEach((function(t){var n=(0,a.default)(t.txnDate),s=(0,r.default)(n,"MMMM yyyy");e[s]?e[s].push(t):e[s]=[t],i.push(t)})),f((0,o.XI)({transactions:i,txnList:e,total:n.total}))}_(n)})).catch(h).finally((function(){"pdf"===d?(0,i.V_)(!1):f((0,o.Rn)(!1))}))}))}},l=function(t,n,e){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"json";return function(r){return new Promise((function(c,l){(0,i.V_)(!0);var u="crypto"===n?"v1/crypto/".concat(t,"/transaction/").concat(e):"v1/account/".concat(t,"/transaction/").concat(e,"?export=").concat(a);s.Z.get(u,{responseType:"pdf"===a?"blob":"json"}).then((function(t){var n=t.data;"pdf"!==a&&r((0,o.IR)(n)),c(n)})).catch((function(t){t.response&&t.response.data?l(t.response.data):l(t)})).finally((function(){(0,i.V_)(!1)}))}))}}},3692:function(t,n,e){e.d(n,{T:function(){return r},z:function(){return a}});var a=function(t){return t.LOGOUT="logout",t.CARD_REFRESH="card_refresh",t.TRANSACTION_REFRESH="transaction_refresh",t}({}),r={_events:{},dispatch:function(t,n){this._events[t]&&this._events[t].forEach((function(t){return t(n)}))},subscribe:function(t,n){var e=this;this._events[t]||(this._events[t]=[]);var a=this._events[t].push(n);return function(){e.unsubscribe(t,a-1)}},unsubscribe:function(t,n){this._events[t]&&(void 0!==n&&this._events[t][n]?this._events[t].splice(n,1,(function(){})):delete this._events[t])}}},9336:function(t,n,e){e.d(n,{Z:function(){return A}});var a=e(1413),r=e(9439),i=e(2791),s=e(2020),o=e(8735),c=e(5798),l=e(6450),u=e(5048),d=e(4771),f=e(1951),m=e(7689),_=e(4144),h={bodyStyles:"TransactionsList_bodyStyles__DV1tn",transaction__box:"TransactionsList_transaction__box__rlmOM",scrollableDiv:"TransactionsList_scrollableDiv__lUBu3",transactions__search:"TransactionsList_transactions__search__X7iW3",transactions__search__icon:"TransactionsList_transactions__search__icon__rJTxm",transactions__search__input:"TransactionsList_transactions__search__input__YC3Vr",transactions__filter:"TransactionsList_transactions__filter__U5l+w",transactions__list_month:"TransactionsList_transactions__list_month__7mtUP",transactions__month_header:"TransactionsList_transactions__month_header__6369R",transactions__list_item:"TransactionsList_transactions__list_item__elp8k",tag:"TransactionsList_tag__vt8SQ",tag__intrabank:"TransactionsList_tag__intrabank__rkOgY",tag__card:"TransactionsList_tag__card__I1gKw",transaction__description:"TransactionsList_transaction__description__XrkJ8",transaction__received:"TransactionsList_transaction__received__k9ILX",transaction__sent:"TransactionsList_transaction__sent__HFnJf"},p=e(5304),v=e(729),x=e(80),g=e(6559),T=e(1605),y=e(7427),D=e(7514),j=e(4661),N=e(3692),w=e(184),b=i.lazy((function(){return Promise.all([e.e(4398),e.e(4044),e.e(5326),e.e(219)]).then(e.bind(e,219))})),C=i.memo((function(t){var n,a=t.transactionData,r=t.dateFormat,c=(0,s.$)().t,l=(0,j.y)().open,d=(0,p.CG)((function(t){return t.core.ui}),u.wU),m=(0,i.useMemo)((function(){return(0,f.default)(new Date(a.createdAt),r)}),[r,a.createdAt]),_=(0,i.useMemo)((function(){var t=a.walletId?a.amount:(0,x.OH)(a.amount);return parseFloat(a.amount)>0?"+".concat(t):t}),[a]),v=(0,i.useMemo)((function(){var t,n;return"pending"===a.status?"#FFAC4A":"canceled"===a.status?"#FF4A4A":"".concat("debit"===a.txnType?null===(t=d.modules.transactions)||void 0===t?void 0:t.amountSentColor:null===(n=d.modules.transactions)||void 0===n?void 0:n.amountReceivedColor)}),[a]);return(0,w.jsxs)(o.HC,{backgroundColor:"var(--bg-white)","data-class":"transaction-list-item","data-testid":"transaction-item-".concat(a.id),onClick:function(){l(i.lazy((function(){return Promise.all([e.e(9259),e.e(714)]).then(e.bind(e,714))})),{id:a.id})},className:h.transactions__list_item,children:[(0,w.jsx)(o.xu,{className:"".concat(h.tag," ").concat(h["tag__".concat(a.transferType)]),children:(0,w.jsx)(o.xv,{textTransform:"capitalize",variant:"small",textAlign:"center",color:"inherit",textOverflow:"ellipsis",overflow:"hidden",children:c(["transactions_list.".concat(a.transferType),a.transferType||""])})}),(0,w.jsxs)(o.xu,{className:h.transaction__description,children:[(0,w.jsx)(o.xv,{variant:"regular",className:"text-dark",textAlign:"left",children:a.title}),(0,w.jsx)(o.xv,{variant:"small",className:"text-light",textAlign:"left",children:"pending"===a.status?"Pending":m})]}),(0,w.jsx)(o.xv,{variant:"small",title:"".concat((0,x.OH)(a.amount)),textAlign:"right",fontWeight:null===(n=d.modules.transactions)||void 0===n?void 0:n.amountFontWeight,color:v,children:_})]})})),A=function(t){var n=t.showFilter,e=t.showExport,f=t.showMonth,A=t.scrollBoxHeight,S=t.showSearch,U=t.showCompactView,L=t.accountType,k=t.filterRequest,Z=t.transactionsPerView,M=void 0===Z?20:Z,R=t.dateFormat,O=(0,s.$)().t,z=(0,j.y)().open,F=(0,m.s0)(),I=(0,i.useState)(""),H=(0,r.Z)(I,2),P=H[0],E=H[1],V=(0,i.useState)(""),J=(0,r.Z)(V,2),G=J[0],$=J[1],Y=(0,i.useRef)(0),W=(0,i.useRef)(!1),X=(0,p.Qo)(),q=(0,p.CG)((function(t){return t.transaction.transactionLoading}),u.wU),B=(0,p.CG)((function(t){return t.transaction.transactions}),u.wU),Q=(0,p.CG)((function(t){return t.transaction.txnList}),u.wU),K=(0,p.CG)((function(t){return t.transaction.total}),u.wU),tt=(0,p.CG)((function(t){return t.account.selectedAccount}),u.wU),nt=(0,p.CG)((function(t){return t.crypto.selectedAccount}),u.wU),et=(0,p.CG)((function(t){return t.transaction.filters}),u.wU),at=B.length,rt=(0,i.useMemo)((function(){return(0,a.Z)((0,a.Z)({},et.data),{},{timePeriod:et.tmpStates.timePeriod})}),[et]),it=Y.current/M+1;(0,v.bX)((function(){Y.current=0,$(P)}),1e3,[P]);var st=(0,i.useRef)(1),ot=(0,i.useCallback)((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"json",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(0,a.Z)({},rt);console.log("called");var e="cash"===L&&tt?tt.id:"crypto"===L&&nt?nt.id:"";if(""!==e){var r=JSON.parse(JSON.stringify(n));k&&k.type&&k.id?"contact"===k.type?r.contactId=k.id:"card"===k.type&&(r.cardId=k.id):(r.contactId=void 0,r.cardId=void 0),"card"===r.txnType&&(r.txnType=void 0,r.transferType="card"),"0.00"!==r.maxAmount&&"0"!==r.maxAmount||delete r.maxAmount,st.current+=1,st.current<=5?X((0,y.f)(e,L,"pdf"===t?100:M,"pdf"===t?0:Y.current,G,r,t)).then((function(n){if("pdf"===t){var e=window.URL.createObjectURL(n),a=document.createElement("a");a.href=e,a.download="statement.pdf",a.click(),a.remove()}})).catch(x.WH):console.log("count",st.current)}}),[tt,G,Y,M,rt,k,st]);(0,i.useEffect)((function(){console.log("changed 1",rt,G,tt),ot()}),[G,tt]),(0,i.useEffect)((function(){return N.T.subscribe(N.z.TRANSACTION_REFRESH,(function(){Y.current=0,console.log("filters",rt)}))}),[rt]);var ct=(0,i.useCallback)((function(){F("/transactions")}),[]),lt=(0,i.useCallback)((function(t){var n=JSON.parse(JSON.stringify((0,a.Z)({},et))),e=n.data,r=n.tmpStates;"txnType"===t?(e.txnType=void 0,e.transferType=void 0,r.transactionType=void 0):"amount"===t?(e.minAmount=void 0,e.maxAmount=void 0,r.amount={min:"",max:""}):"timePeriod"===t&&(e.startDate=void 0,e.endDate=void 0,r.startDate=void 0,r.endDate=void 0,r.timePeriod=void 0),X((0,D.L5)({data:e,tmpStates:r})),setTimeout((function(){ot("json",e)}),0)}),[et]),ut=function(){return Object.keys(Q).map((function(t){return(0,w.jsxs)(o.xu,{"data-testid":"month-group-".concat(t.replace(/ /g,"_")),children:[f&&(0,w.jsx)(o.xv,{"data-testid":"month-name-text",variant:"large",className:h.transactions__month_header,children:t}),(0,w.jsx)(o.aV,{className:h.transactions__list_month,"data-class":"transaction-list",children:Q[t].map((function(t){return(0,w.jsx)(C,{transactionData:t,dateFormat:R},t.id)}))})]},"tr-".concat(t))}))},dt=(0,i.useMemo)((function(){return{credit:O("filter.credits"),debit:O("filter.debits"),card:O("filter.cardTransactions")}}),[]);return(0,w.jsx)(o.xu,{className:h.bodyStyles,children:q&&1===it&&!W.current?(0,w.jsx)(g.Z,{name:"TransactionListView",showHeader:!U}):(0,w.jsxs)(o.xu,{width:"100%",className:h.transaction__box,children:[(0,w.jsxs)("div",{children:[(0,w.jsxs)(o.Ug,{width:"100%",children:[(0,w.jsx)(o.xv,{"data-testid":"heading",variant:"large",mr:"auto",children:O("transactions_list.title")}),U&&0!==K?(0,w.jsxs)(o.xv,{variant:"regular",className:"text-light",fontSize:"16px",cursor:"pointer",onClick:ct,children:[O("transactions_list.viewAll"),(0,w.jsx)(_.Z,{style:{marginLeft:"8px"},icon:"Arrow-small-right",size:12,className:"svg-light-grey-1"})]}):null,e?(0,w.jsxs)(o.Ug,{ml:"auto",cursor:"pointer",onClick:function(){return ot("pdf")},"data-testid":"export-icon",children:[(0,w.jsx)(_.Z,{icon:"icon-export",size:16}),(0,w.jsx)(o.xv,{variant:"regular",className:"transactions__export-title",children:O("transactions_list.exportTitle")}),(0,w.jsx)(_.Z,{icon:"Arrow-small-right",size:12,className:"svg-light-grey-1"})]}):null]}),(0,w.jsxs)(o.Ug,{my:S||n?"16px":"0px",children:[S?(0,w.jsxs)(o.xu,{className:h.transactions__search,children:[(0,w.jsx)(_.Z,{icon:"icon-search",className:h.transactions__search__icon,size:18}),(0,w.jsx)(c.II,{"data-testid":"search-input",placeholder:O("transactions_list.searchTransactions"),variant:"primary",className:h.transactions__search__input,value:P,onChange:function(t){W.current=!0,E(t.target.value)}})]}):null,n?(0,w.jsx)(o.M5,{className:"".concat(h.transactions__filter),"data-testid":"filter-handler",onClick:function(){z(b)},children:(0,w.jsx)(_.Z,{icon:"icon-filter",size:20})}):null]})]}),(0,w.jsxs)(o.Ug,{spacing:4,marginBottom:"16px",children:[rt.txnType?(0,w.jsxs)(l.Vp,{variant:"primary",padding:"10px","data-testid":"filter-tag-txnType",children:[(0,w.jsx)(l.Sn,{fontSize:"12px",textTransform:"uppercase",children:dt[rt.txnType]}),(0,w.jsx)(l.SD,{onClick:function(){lt&&lt("txnType")}})]}):null,rt.minAmount&&"0.00"!==rt.minAmount||rt.maxAmount&&"0.00"!==rt.maxAmount?(0,w.jsxs)(l.Vp,{variant:"primary",padding:"10px","data-testid":"filter-tag-amount",children:[(0,w.jsx)(l.Sn,{fontSize:"12px",textTransform:"uppercase",children:rt.minAmount&&rt.maxAmount&&"0.00"!==rt.minAmount&&"0.00"!==rt.maxAmount?"".concat((0,x.OH)(rt.minAmount)," - ").concat((0,x.OH)(rt.maxAmount)):rt.minAmount&&"0.00"!==rt.minAmount?(0,x.OH)(rt.minAmount):"".concat((0,x.OH)("0.00")," - ").concat((0,x.OH)(rt.maxAmount||""))}),(0,w.jsx)(l.SD,{onClick:function(){lt&&lt("amount")}})]}):null,rt.timePeriod&&("custom"!==rt.timePeriod||rt.startDate&&""!==rt.startDate||rt.endDate&&""!==rt.endDate)?(0,w.jsxs)(l.Vp,{variant:"primary",padding:"10px","data-testid":"filter-tag-time",children:[(0,w.jsx)(l.Sn,{fontSize:"12px",textTransform:"uppercase",children:"custom"===rt.timePeriod?rt.startDate&&rt.endDate&&""!==rt.startDate&&""!==rt.endDate?"".concat(rt.startDate," - ").concat(rt.endDate):rt.startDate&&""!==rt.startDate?rt.startDate:rt.endDate:O("filter.".concat(rt.timePeriod))}),(0,w.jsx)(l.SD,{onClick:function(){lt&&lt("timePeriod")}})]}):null]}),q&&W.current?(0,w.jsx)(g.Z,{name:"TransactionListView",showHeader:!1}):(0,w.jsx)("div",{className:h.scrollableDiv,id:"scrollableDiv",children:U?ut():(0,w.jsx)(d.Z,{scrollThreshold:.6,height:A,dataLength:at,next:function(){Y.current=it*M,setTimeout((function(){console.log("call from infi"),ot()}),0)},hasMore:at<K&&0!==K,loader:(0,w.jsx)(o.M5,{my:3,children:(0,w.jsx)(T.Z,{showModal:!1,show:!0})}),endMessage:q?null:(0,w.jsxs)(w.Fragment,{children:[0!==K?(0,w.jsx)(o.iz,{className:"no_transaction"}):null,(0,w.jsx)(o.M5,{py:2,children:(0,w.jsx)(o.xv,{variant:"regular",textAlign:"center",className:"text-light",children:O(0===K?"transactions_list.noData":"transactions_list.noMoreTransactions")})})]}),scrollableTarget:"scrollableDiv",children:ut()})})]})})}},2729:function(t,n,e){e.d(n,{qk:function(){return i},vh:function(){return r},yJ:function(){return a}});Math.pow(10,8);var a=6e4,r=36e5,i=1e3},9831:function(t,n,e){e.r(n),e.d(n,{default:function(){return s}});var a=e(2729),r=e(4522),i=e(9297);function s(t,n){var e;(0,r.Z)(1,arguments);var s=(0,i.Z)(null!==(e=null===n||void 0===n?void 0:n.additionalDigits)&&void 0!==e?e:2);if(2!==s&&1!==s&&0!==s)throw new RangeError("additionalDigits must be 0, 1 or 2");if("string"!==typeof t&&"[object String]"!==Object.prototype.toString.call(t))return new Date(NaN);var h,p=function(t){var n,e={},a=t.split(o.dateTimeDelimiter);if(a.length>2)return e;/:/.test(a[0])?n=a[0]:(e.date=a[0],n=a[1],o.timeZoneDelimiter.test(e.date)&&(e.date=t.split(o.timeZoneDelimiter)[0],n=t.substr(e.date.length,t.length)));if(n){var r=o.timezone.exec(n);r?(e.time=n.replace(r[1],""),e.timezone=r[1]):e.time=n}return e}(t);if(p.date){var v=function(t,n){var e=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+n)+"})|(\\d{2}|[+-]\\d{"+(2+n)+"})$)"),a=t.match(e);if(!a)return{year:NaN,restDateString:""};var r=a[1]?parseInt(a[1]):null,i=a[2]?parseInt(a[2]):null;return{year:null===i?r:100*i,restDateString:t.slice((a[1]||a[2]).length)}}(p.date,s);h=function(t,n){if(null===n)return new Date(NaN);var e=t.match(c);if(!e)return new Date(NaN);var a=!!e[4],r=d(e[1]),i=d(e[2])-1,s=d(e[3]),o=d(e[4]),l=d(e[5])-1;if(a)return function(t,n,e){return n>=1&&n<=53&&e>=0&&e<=6}(0,o,l)?function(t,n,e){var a=new Date(0);a.setUTCFullYear(t,0,4);var r=a.getUTCDay()||7,i=7*(n-1)+e+1-r;return a.setUTCDate(a.getUTCDate()+i),a}(n,o,l):new Date(NaN);var u=new Date(0);return function(t,n,e){return n>=0&&n<=11&&e>=1&&e<=(m[n]||(_(t)?29:28))}(n,i,s)&&function(t,n){return n>=1&&n<=(_(t)?366:365)}(n,r)?(u.setUTCFullYear(n,i,Math.max(r,s)),u):new Date(NaN)}(v.restDateString,v.year)}if(!h||isNaN(h.getTime()))return new Date(NaN);var x,g=h.getTime(),T=0;if(p.time&&(T=function(t){var n=t.match(l);if(!n)return NaN;var e=f(n[1]),r=f(n[2]),i=f(n[3]);if(!function(t,n,e){if(24===t)return 0===n&&0===e;return e>=0&&e<60&&n>=0&&n<60&&t>=0&&t<25}(e,r,i))return NaN;return e*a.vh+r*a.yJ+1e3*i}(p.time),isNaN(T)))return new Date(NaN);if(!p.timezone){var y=new Date(g+T),D=new Date(0);return D.setFullYear(y.getUTCFullYear(),y.getUTCMonth(),y.getUTCDate()),D.setHours(y.getUTCHours(),y.getUTCMinutes(),y.getUTCSeconds(),y.getUTCMilliseconds()),D}return x=function(t){if("Z"===t)return 0;var n=t.match(u);if(!n)return 0;var e="+"===n[1]?-1:1,r=parseInt(n[2]),i=n[3]&&parseInt(n[3])||0;if(!function(t,n){return n>=0&&n<=59}(0,i))return NaN;return e*(r*a.vh+i*a.yJ)}(p.timezone),isNaN(x)?new Date(NaN):new Date(g+T+x)}var o={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},c=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,l=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,u=/^([+-])(\d{2})(?::?(\d{2}))?$/;function d(t){return t?parseInt(t):1}function f(t){return t&&parseFloat(t.replace(",","."))||0}var m=[31,null,31,30,31,30,31,31,30,31,30,31];function _(t){return t%400===0||t%4===0&&t%100!==0}}}]);
//# sourceMappingURL=9336.d30be893.chunk.js.map